<div style="padding: 3em">
  <!-- Stepper: Set linear mode to true for validation between steps -->
  <mat-horizontal-stepper [linear]="true">
    
    <!-- Step 1: Personal Info -->
    <mat-step [stepControl]="jobApplication.get('personalInfo')!" label="Personal Information">
      <form [formGroup]="jobApplication.get('personalInfo')!">
        <mat-form-field>
          <mat-label>Name</mat-label>
          <input matInput formControlName="name" placeholder="Enter your name" />
          <mat-error *ngIf="jobApplication.get('personalInfo')?.get('name')?.hasError('required')">
            Name is required
          </mat-error>
        </mat-form-field>
        
        <mat-form-field>
          <mat-label>Email</mat-label>
          <input matInput formControlName="email" placeholder="Enter your email" />
          <mat-error *ngIf="jobApplication.get('personalInfo')?.get('email')?.hasError('required')">
            Email is required
          </mat-error>
          <mat-error *ngIf="jobApplication.get('personalInfo')?.get('email')?.hasError('email')">
            Please enter a valid email
          </mat-error>
        </mat-form-field>

        <mat-form-field>
          <mat-label>Phone</mat-label>
          <input matInput formControlName="phone" placeholder="Enter your phone number" />
          <mat-error *ngIf="jobApplication.get('personalInfo')?.get('phone')?.hasError('required')">
            Phone number is required
          </mat-error>
        </mat-form-field>

        <div>
          <button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>

    <!-- Step 2: Experience -->
    <mat-step [stepControl]="jobApplication.get('experience')!" label="Work Experience">
      <form [formGroup]="jobApplication.get('experience')!">
        <mat-form-field>
          <mat-label>Years of Experience</mat-label>
          <input matInput formControlName="yearsExperience" placeholder="Enter your experience in years" />
          <mat-error *ngIf="jobApplication.get('experience')?.get('yearsExperience')?.hasError('required')">
            Experience is required
          </mat-error>
        </mat-form-field>

        <mat-form-field>
          <mat-label>Job Title</mat-label>
          <input matInput formControlName="jobTitle" placeholder="Enter your job title" />
          <mat-error *ngIf="jobApplication.get('experience')?.get('jobTitle')?.hasError('required')">
            Job title is required
          </mat-error>
        </mat-form-field>

        <div>
          <button matStepperPrevious>Back</button>
          <button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>

    <!-- Step 3: Submit -->
    <mat-step label="Submit">
      <p>Review and Submit your application.</p>
      <div>
        <button matStepperPrevious>Back</button>
        <button mat-raised-button color="primary" (click)="onSubmit()" [disabled]="!jobApplication.valid">Submit</button>
      </div>
    </mat-step>

  </mat-horizontal-stepper>

  <!-- Output form values -->
  <pre>{{ jobApplication.value | json }}</pre>
</div>
